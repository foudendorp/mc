{
  "ActionRequiredByDateTime": null,
  "Attachments": null,
  "AttachmentsArchive": null,
  "Body": {
    "Content": "<div>A security risk exists in the Remote Authentication Dial-In User Service (RADIUS) protocol. <a href=\"https://learn.microsoft.com/dotnet/api/system.security.cryptography.md5?view=net-8.0\" rel=\"noopener noreferrer\" target=\"_blank\">MD5</a> collision problems affect <a href=\"https://learn.microsoft.com/windows-server/networking/technologies/nps/nps-udp-ports-configure\" rel=\"noopener noreferrer\" target=\"_blank\">User Datagram Protocol</a> or UDP-based RADIUS traffic over the internet. Data packets are at risk of forgery or changes to them during transit. To learn more, see <a href=\"https://support.microsoft.com/topic/kb5040268-how-to-manage-the-access-request-packets-attack-vulnerability-associated-with-cve-2024-3596-a0e2f0b1-f200-4a7b-844f-48d1d5ab9e66\" rel=\"noopener noreferrer\" target=\"_blank\">KB5040268</a>.</div><div><br></div><div>As of July 9, 2024, Windows updates support the <b>Message-Authenticator</b> attribute in <b>Access-Request</b> packets. The new RADIUS standards mandate this change.</div><div>However, if you install the July 2024, or later, updates, <a href=\"https://learn.microsoft.com/windows-server/networking/technologies/nps/nps-top\" rel=\"noopener noreferrer\" target=\"_blank\">Network Policy Server (NPS)</a> connection failures can happen. This update does not cause these connection failures. This only occurs if your company’s firewall or RADIUS solution does not support this attribute. To learn more, see <a href=\"https://support.microsoft.com/topic/kb5043417-radius-authentication-to-nps-might-fail-with-the-july-2024-security-update-and-later-updates-1a9d6cd4-5f8a-40eb-b2d6-f3a11cc0c308\" rel=\"noopener noreferrer\" target=\"_blank\">KB5043417</a>.</div><div><br></div><div>We recommend that you enable the <b>Message-Authenticator</b> attribute in <b>Access-Request</b> packets. Doing this addresses this NPS issue and the security risk.</div><div>&nbsp;</div><div><b>When will this happen:</b>&nbsp;</div><div><br></div><div>As of July 9, 2024, you now have more information to address this NPS issue and security risk in your environment.</div><div>&nbsp;</div><div><b>How this will affect your organization:</b>&nbsp;</div><div><br></div><div>The security risk requires physical access to both the RADIUS network and the NPS. Also, it does not apply when RADIUS traffic goes over a VPN. By making one or more of the changes below, you can enhance the security of UDP-based RADIUS traffic. You can also avoid NPS connection failures.</div><div><br></div><div><b>What you need to do to prepare:</b>&nbsp;</div><div><br></div><div>To help protect your environment, we recommend that you enable the following:</div><div><br></div><ul><li>Set the&nbsp;<b>Message-Authenticator</b>&nbsp;attribute in&nbsp;<b>Access-Request</b>&nbsp;packets.&nbsp;Make sure all&nbsp;<b>Access-Request</b>&nbsp;packets include the&nbsp;<b>Message-Authenticator</b>&nbsp;attribute. By default, the&nbsp;<b>Message-Authenticator</b>&nbsp;attribute is turned off. We recommend&nbsp;turning this option on.</li></ul><div><br></div><ul><li>Verify the&nbsp;<b>Message-Authenticator</b>&nbsp;attribute in&nbsp;<b>Access-Request</b>&nbsp;packets.&nbsp;Consider enforcing validation of the&nbsp;<b>Message-Authenticator</b>&nbsp;attribute on&nbsp;<b>Access-Request</b>&nbsp;packets.&nbsp;<b>Access-Request</b>&nbsp;packets without this attribute will not be processed. By default, the&nbsp;<b>Access-Request messages must contain the message-authenticator attribute</b>&nbsp;option is turned off. We recommend turning this option on.</li></ul><div><br></div><ul><li>Verify the&nbsp;<b>Message-Authenticator</b>&nbsp;attribute in&nbsp;<b>Access-Request</b>&nbsp;packets if the&nbsp;<b>Proxy-State</b>&nbsp;attribute is present.&nbsp;Optionally, enable the&nbsp;<b>limitProxyState</b>&nbsp;configuration if enforcing validation of the&nbsp;<b>Message-Authenticator</b>&nbsp;attribute on&nbsp;<b>Access-Request</b>&nbsp;packets cannot be performed. This configuration will validate that&nbsp;<b>Access-Request</b>&nbsp;packets containing the&nbsp;<b>Proxy-State</b>&nbsp;attribute also contain the&nbsp;<b>Message-Authenticator</b>&nbsp;attribute. By default, the&nbsp;<b>limitproxystate</b>&nbsp;attribute is turned off. We recommend turning this attribute on.</li></ul><div><br></div><ul><li>Verify the&nbsp;<b>Message-Authenticator</b>&nbsp;attribute in RADIUS response packets:&nbsp;<b>Access-Accept</b>,&nbsp;<b>Access-Reject</b>,&nbsp;and&nbsp;<b>Access-Challenge</b>.&nbsp;Enable the&nbsp;<b>requireMsgAuth</b>&nbsp;configuration to enforce dropping the RADIUS response packets from remote servers that lack the&nbsp;<b>Message-Authenticator</b>&nbsp;attribute. By default, the&nbsp;<b>requiremsgauth</b>&nbsp;attribute is tuned off. We recommend turning this attribute on.</li></ul><div><br></div><div>You can find detailed guidance on applying these in <a href=\"https://support.microsoft.com/topic/kb5040268-how-to-manage-the-access-request-packets-attack-vulnerability-associated-with-cve-2024-3596-a0e2f0b1-f200-4a7b-844f-48d1d5ab9e66\" rel=\"noopener noreferrer\" target=\"_blank\">KB5040268</a>. See the Additional information section below.</div><div><br></div><div><b>Additional information:</b>&nbsp;</div><div><br></div><div>For more information about this security risk and NPS issue, see:</div><ul><li><a href=\"https://support.microsoft.com/topic/kb5040268-how-to-manage-the-access-request-packets-attack-vulnerability-associated-with-cve-2024-3596-a0e2f0b1-f200-4a7b-844f-48d1d5ab9e66\" rel=\"noopener noreferrer\" target=\"_blank\">KB5040268: How to manage the Access-Request packets attack vulnerability associated with CVE-2024-3596</a></li><li><a href=\"https://support.microsoft.com/topic/kb5043417-radius-authentication-to-nps-might-fail-with-the-july-2024-security-update-and-later-updates-1a9d6cd4-5f8a-40eb-b2d6-f3a11cc0c308\" rel=\"noopener noreferrer\" target=\"_blank\">KB5043417: RADIUS authentication to NPS might fail with the July 2024 security update and later updates</a></li><li><a href=\"https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-3596\" rel=\"noopener noreferrer\" target=\"_blank\">CVE-2024-3596</a></li><li><a href=\"https://learn.microsoft.com/windows-server/networking/technologies/nps/nps-top\" rel=\"noopener noreferrer\" target=\"_blank\">Network Policy Server (NPS)</a></li><li><a href=\"•%09https:/learn.microsoft.com/windows-server/networking/technologies/nps/nps-udp-ports-configure\" rel=\"noopener noreferrer\" target=\"_blank\">User Datagram Protocol (UDP)</a></li></ul>",
    "ContentType": "html"
  },
  "Category": "stayInformed",
  "Details": [],
  "EndDateTime": "2025-08-16T20:21:12.337Z",
  "HasAttachments": false,
  "Id": "MC863964",
  "IsMajorChange": false,
  "LastModifiedDateTime": "2024-08-16T20:21:13.263Z",
  "Services": [
    "Windows"
  ],
  "Severity": "normal",
  "StartDateTime": "2024-08-16T20:21:12.367Z",
  "Tags": [
    "Admin impact"
  ],
  "Title": "Protect against security risks and NPS connection failures that affect RADIUS server environments",
  "ViewPoint": {
    "IsArchived": null,
    "IsFavorited": null,
    "IsRead": null
  },
  "AdditionalProperties": {}
}
